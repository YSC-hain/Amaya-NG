# FACTS（v0.4）- Amaya-NG 项目事实与硬约束

## 0. 两种 LLM（禁止混淆）
- **Runtime LLM**：Amaya 运行时对话/规划/工具调用的模型。
- **Builder LLM**：用于写代码/重构/写文档的模型（vibe coding），必须遵循 docs/dev/LLM_GUIDE.md。

---

## 1. 项目目标（当前阶段）
Amaya-NG 不是“无限接近真人”的拟人机器，而是：
- 拟真的陪伴型聊天体验（自然对话、低机械感）
- 在陪伴对话中自然完成 **时间规划与管理**
- 支持 **系统托管提醒**（可靠送达、可恢复）
- 支持一套面向用户的 **知识库（KB）**（模板化，便于扩展）

---

## 2. 单用户与串行处理
- **非多用户**：没有 user_id / 映射表 / 隔离等复杂的设计。
- 为简化系统，可接受 **串行** 执行（一次处理一个工具调用/一个状态写入）。

---

## 3. 三类输出（必须同时存在）
1) **系统托管提醒**：可靠送达（可多渠道/ask机制），由系统调度，支持崩溃恢复。
2) **结构化 Plan**：以 `plan.json` 为唯一真相源，并渲染为只读 `plan.md`。
3) **知识库（KB）**：面向用户的长期信息，模板化、可扩展；首批包含 preferences/goals/projects。

---

## 4. 规划与提醒：TickTick 风格（关键定义）
- **软性规划（soft）**：没有明确 reminder 的规划；允许仅设置到“天”（date_only）。
- **硬性规划（hard）**：带 reminder 的规划；提醒从属于规划。
- hard/soft 不限定于某个清单（inbox/nowTask/... 均可）。

### 4.1 日期-only 的硬性需求处理
当用户希望“提醒我”，但只提供日期（没有具体时间）：
- 不得猜时间创建 reminder。
- 采取策略：先落入 **软性 date_only** + 设置 `next_review_at`；
- 在 **前一晚或当天早上** 再由 Runtime LLM 视情况确认具体提醒时间点，并转 hard。

---

## 5. 清单（Lists）固定集合
计划系统至少包含以下清单（对应 GTD 风格）：
- inbox
- nowTask
- next_action
- someday
- waiting
- routine
- checklist

语义要点：
- `next_action`：可选/不重要/忘了也无妨的事项，默认低优先级（priority=low）。

---

## 6. 时区规则
- reminder.at 使用 **用户时区** 语义。
- 用户时区默认值：固定写入（Asia/Shanghai）
- 用户时区存放在 `kb/preferences` 中，作为后续展示与计算依据。

---

## 7. 高优先级送达与 ask 机制
- 对 high/critical：可采用邮件等辅助手段确保送达，并带 ask（需要用户确认/回应）。
- 具体重试/时间细节暂不固定，属于后续实现策略；必须在文档与配置中显式定义后才能启用。
