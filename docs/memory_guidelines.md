# 记忆存储规范（建议）

> 目标：控制文件体积、降低上下文噪声、提升检索与摘要效率。

## 命名与分层
- **核心档案（常驻上下文）**：
  - `user_profile.md`：性格、偏好、重要联系人、禁忌。
  - `current_goals.md`：当前 3-5 个目标，附状态与下一步行动。
  - `plan.md`：近期日程/安排，与结构化日程表关联。
  - `routine.json`：结构化日程表（按天记录，覆盖课程/自习/活动等）。
- **任务与项目**：
  - `projects/<project_name>.md`：单项目概览，包含目标、里程碑、风险、下一步。
  - `tasks/<yyyy-mm>.md`：当月任务列表与完成记录；跨月迁移未完任务。
- **日记与反思**：
  - `journal/<yyyy-mm-dd>.md`：当天关键事件（控制在 300-500 字），次日合并为摘要。
  - `journal_summary_<yyyy>.md`：按月/季度追加摘要，避免日记碎片膨胀。
- **资料与清单**：
  - `references/<topic>.md`：常用模板、决策准则、健康/学习 checklist。
  - `course_schedule.md`：原始课表（可选），用于提取未来 2-3 天并写入 `routine.json`。

## 内容与体积控制
- 每个文件建议不超过 **1,200 词或 80 KB**；超过阈值时必须拆分或摘要。
- 对于长对话/长文档，先生成“**摘要块**”：
  - 结构：标题 + 时间戳 + 150-250 字摘要 + 关键 TODO。
  - 存入 `*_summary` 区块，正文可归档/删除。
- 记忆条目需附 **时间标记**（ISO 日期/时间段），方便模型推断时序。

## 置顶/默认可见策略
- 默认可见文件：`routine.json`, `plan.md`, `user_profile.md`, `current_goals.md`。
- 仅将 **3-5 个** 高优先级文件 Pin，并定期审查是否仍需常驻。

## 提醒与事件
- 挂起提醒由系统生成摘要；手写的长提醒内容应在 `tasks`/`plan.md` 记录，并在提醒 prompt 中只引用摘要。
- 完成或过期的提醒应追加到相应任务/项目的“进展”段落，并从提醒文件移除。

## 清理与归档流程
- 每周整理：
  - 将当周日记合并为 `journal/<yyyy-ww>-summary.md`，并更新年度摘要。
  - 清理已完成任务，记录结论/经验。
- 每月整理：
  - 对 `plan.md` 和 `current_goals.md` 进行重排，移除失效目标。
  - 对 Pin 列表做一次审查，保持精简。

## 提示词建议
- 写入文件时，保持标题 + bullet 的轻量格式；减少口语化句式。
- 在回复用户前，先检查目标文件是否超过阈值，必要时提示“需要摘要/拆分”。
- 处理连续消息时，合并上下文后再写入，避免重复摘要。
